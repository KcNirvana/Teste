{"time":"0016","tplId":"QUICKPAY@cashier-card-detail-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-card-detail-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","children":[{"text":"var getTag=amc.fn.getById;var hide=amc.fn.hide;var show=amc.fn.show;var rpc=amc.rpcData;var path=amc.path+\"alipay_msp_\";var infoPng=path+\"info\";var cvvDlgPng=path+\"cvv\";var validateDlgPng=path+\"validate\";var phoneDlgPng=path+\"phone_info\";var certTypeTextArray=new Array();var certTypeValueArray=new Array();var currentValue=\"\";var inputItems=rpc.needinput;var inputsMap=[{name:\"cvv2\",id:\"cvv2\"},{name:\"validate\",id:\"validate\"},{name:\"username\",id:\"userName\"},{name:\"certno\",id:\"certNo\"},{name:\"bankmobile\",id:\"bankMobile\"}];var showing={};function init(){try{initUI();if(amc.fn.logPageInit){amc.fn.logPageInit(true)}}catch(a){if(amc.fn.logPageInit){amc.fn.logPageInit()}}}function initUI(){var c=amc.fn.getNav(amc.res.navBack,\"{{return}}\",\"{{write_card_info}}\",null,null,onBack,null);getTag(\"body\").insertBefore(c,getTag(\"mainBody\"));if(rpc.isCredit!==undefined||rpc.bankname){if(rpc.isCredit!==undefined){getTag(\"cardType\").innerText=rpc.isCredit?\"{{credit_card}}\":\"{{store_card}}\"}getTag(\"cardName\").innerText=rpc.bankname||\"\";show(\"cardTypeArea\")}inputItems.cvv2=rpc.cvv2;inputItems.validate=rpc.validate;for(var b=0;b<inputsMap.length;b++){var a=inputsMap[b][\"name\"];var d=inputsMap[b][\"id\"];if(!inputItems[a]||(inputItems[a].disable&&!inputItems[a].value)){getTag(d).disabled=true}else{getTag(d).value=inputItems[a].value||\"\";if(inputItems[a].disable){getTag(d).disabled=true;getTag(d).style.color=\"#a5a5a5\"}show(d+\"Area\");showing[d]=true}}initCertTypePicker();if(rpc.protocols&&rpc.protocols.length){show(\"protocolsArea\")}if(!(showing.validate||showing.cvv2)){hide(\"cvv2ValidateSpace\")}if(!(showing.userName||showing.certNo||showing.certType)){hide(\"nameCertSpace\")}getTag(\"cvvInfoImg\").src=infoPng;getTag(\"validateInfo\").src=infoPng;getTag(\"phoneInfo\").src=infoPng;if(amc.isAndroid){getTag(\"loading\").src=amc.path+\"alipay_msp_indicator_white_loading\"}checkInput(\"cvv2\",getTag(\"cvvInfoLayout\"));checkInput(\"validate\",getTag(\"validateInfoLayout\"));checkInput(\"bankMobile\",getTag(\"phoneInfoLayout\"));updateSubmitState()}function updateInputState(a,c){var b=getTag(a);if(b&&b.value&&b.value.length){hide(c)}else{show(c)}}function checkInput(a,b){updateInputState(a,b);updateSubmitState()}var inputVerify={};inputVerify.cvv2={regex:\"^\\\\d{0,4}$\",lastValue:\"\"};inputVerify.validate={regex:\"^\\\\d{2}/\\\\d{2}$\",lastValue:\"\"};inputVerify.bankMobile={regex:\"^[0-9-+]*$\",lastValue:\"\"};inputVerify.certNo={regex:\"(^\\\\d{0,18}$)|(^\\\\d{17}([X|x]{0,1}))$\",lastValue:\"\"};function onInput(c,a){if(c!==\"certNo\"||currentValue===\"A\"){var b=getTag(c).value;if(b.match(inputVerify[c][\"regex\"])){inputVerify[c][\"lastValue\"]=b}else{getTag(c).value=inputVerify[c][\"lastValue\"]}}if(a){updateInputState(c,a)}updateSubmitState()}var cvv2Regex=\"^\\\\d{3,4}$\";var validateRegex=\"^\\\\d{2}/\\\\d{2}$\";var phoneNoRegex=\"(^([+]?[0]{0,2}86|([+]?0{0,2}86-))?1\\\\d{10}$)|(^[+]?[0]{0,2}[1-9]{1}\\\\d{0,7}-\\\\d{7,11}$)\";var certNoRegex=\"(^\\\\d{15}$)|(^\\\\d{17}([0-9]|X)$)\";function updateSubmitState(){var a=document.getElementsByTagName(\"input\");var c=false;for(var b=0;b<a.length;b++){if(a[b].disabled){continue}if(!a[b].value){c=true;break}if(a[b].id===\"cvv2\"&&!a[b].value.match(cvv2Regex)){c=true;break}if(a[b].id===\"validate\"&&!a[b].value.match(validateRegex)){c=true;break}}getTag(\"submit\").disabled=c;getTag(\"btnText\").style.color=c?\"#d2d2d2\":\"#fff\"}function onSubmit(){var e={};if(rpc.isCredit){e.action={name:\"/card/sign\",neec:\"6004\",host:rpc.pci_url,https:true,enctype:\"application/x-www-form-urlencoded\",request_param:\"requestData\"}}else{e.action={name:\"/card/sign\",neec:\"6004\"}}e.action[\"params\"]={cardtype:rpc.cardtype,bankcode:rpc.bankcode,ccdctoken:rpc.ccdctoken,hidden_card_no:rpc.hidden_card_no};e.param={};var c=getTag(\"userName\").value;if(showing.userName&&(c!=inputItems.username[\"value\"])){e.param[\"username\"]=c}var b=getTag(\"certNo\").value;if(showing.certNo&&(b!=inputItems.certno[\"value\"])){if(currentValue==\"A\"){var g=b;if(!g.match(certNoRegex)){toast(\"{{input_right_id_card}}\",\"certNo\");return}}e.param[\"certno\"]=b}if(showing.certType&&(currentValue!=inputItems.certtype[\"default\"])){e.param[\"certtype\"]=currentValue}var d=getTag(\"bankMobile\").value;if(showing.bankMobile&&(d!=inputItems.bankmobile[\"value\"])){var g=d;if(!g.match(phoneNoRegex)){toast(\"{{input_right_phone}}\",\"bankMobile\");return}e.param[\"bankmobile\"]=d}if(showing.cvv2){var a=getTag(\"cvv2\").value||\"\";if(!a.match(cvv2Regex)){toast(\"{{input_valid_cvv2}}\",\"cvv2\");return}e.param[\"cvv2\"]=a}if(showing.validate){var f=getTag(\"validate\").value||\"\";f=f.replace(\"/\",\"\");e.param[\"validate\"]=f||\"\"}amc.fn.hideKeyboard();e.action[\"loadtxt\"]=\"\";document.asyncSubmit(e,function(h){if(h.pageloading===\"0\"){amc.fn.show(\"btnText\");amc.fn.hide(\"loading\")}else{if(h.pageloading===\"1\"){amc.fn.hide(\"btnText\");amc.fn.show(\"loading\")}}});amc.fn.hide(\"btnText\");amc.fn.show(\"loading\")}function toast(b,a){if(!getTag(a)||!b){return}document.toast({text:b,type:\"fail\"},function(){getTag(a).focus()})}var dlgInfo={};dlgInfo.cvv={text:\"{{cvv_info}}\",title:\"{{cvv}}\",img:cvvDlgPng};dlgInfo.validate={text:\"{{validity_info}}\",title:\"{{validity}}\",img:validateDlgPng};dlgInfo.phone={text:\"{{phone_info}}\",title:\"{{phone}}\",img:phoneDlgPng};function onClickInfo(a){getTag(\"dlgTitle\").innerText=dlgInfo[a][\"title\"];getTag(\"dlgText\").innerText=dlgInfo[a][\"text\"];getTag(\"dlgImg\").src=dlgInfo[a][\"img\"];getTag(\"dlg\").showModal()}function onClickCertType(){if(inputItems.certno[\"disable\"]||inputItems.certtype[\"disable\"]||certTypeTextArray.length===1){return}var a={btns:certTypeTextArray,\"default\":certTypeValueArray.indexOf(currentValue),title:\"{{sel_id_no}}\"};document.picker(a,function(d){var b=d.index;var c=certTypeTextArray[b];if(c&&(c!=getTag(\"certType\").innerText)){getTag(\"certType\").innerText=c;getTag(\"certNo\").placeholder=amc.fn.i18nPlaceholderReplace(\"{{please_input_full}}\",c);getTag(\"certNo\").value=\"\";currentValue=certTypeValueArray[b];updateSubmitState()}})}function initCertTypePicker(){if(showing.certNo&&inputItems.certtype){var c=inputItems.certtype[\"value\"];var d=0;for(var e in c){var b=c[e];certTypeTextArray.push(e);certTypeValueArray.push(b);if(b===inputItems.certtype[\"default\"]){d=certTypeTextArray.length-1}}var a=certTypeTextArray[d];currentValue=certTypeValueArray[d]||\"\";if(a){getTag(\"certNo\").placeholder=amc.fn.i18nPlaceholderReplace(\"{{please_input_full}}\",a);getTag(\"certType\").innerText=a}}if(!(certTypeTextArray.length&&certTypeValueArray.length)){getTag(\"certNo\").placeholder=\"{{input_id_no}}\"}else{if(inputItems.certno[\"disable\"]||inputItems.certtype[\"disable\"]||certTypeTextArray.length===1){getTag(\"certType\").style.color=\"#000\";if(certTypeTextArray.length===1&&certTypeValueArray[0]===\"A\"){show(\"idCardOnly\")}}else{getTag(\"arrowRight\").src=amc.res.arrowRight}showing.certType=true;show(\"certTypeArea\")}}function onBack(){amc.fn.hideKeyboard();amc.fn.back()}function showProtocol(){amc.fn.showProtocolList(rpc.protocols)}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]},{"tag":"style","children":[{"text":".info-img {\n    justify-content: flex-end;\n    align-items: center;\n}\n.amc-nav-r-box {\n    display: none;\n}\n.amc-cell-l-box{\n    width:80px;\n    padding-right: 5px;\n}\n.card-name {\n    max-width: 100px;\n}\n.protocol-agree {\n    max-width: 100px;\n}\n.align-start {\n    align-items: flex-start;\n}\n.l-label-ellipsis {\n    -webkit-line-clamp:3;\n    -webkit-box-orient:vertical;\n    display:-webkit-box;\n}\n.detail-cell {\n    align-items: center;\n    background-color: #fff;\n    padding: 5px 15px;\n}\n.dlg-txt {\n    -webkit-line-clamp: 9;\n    -webkit-box-orient:vertical;\n    display:-webkit-box;\n}\n.footer-container {\n    padding-top: 10px;\n    padding-bottom: 10px;\n}","tag":"text"}]}]},{"fullscreen":"true","id":"body","onload":"init()","tag":"body","children":[{"id":"mainBody","tag":"div","children":[{},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{info_sec}}","tag":"text"}],"css":"amc-cell-footer-text amc-flex-1 amc-font-xs"}],"css":"amc-pd-lr amc-pd-b-s"},{},{"id":"cardTypeArea","tag":"div","children":[{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{card_type}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1 l-label-ellipsis"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"cardName","tag":"label","css":"amc-cell-l-text card-name amc-ellipsis"},{"id":"cardType","tag":"label","css":"amc-cell-l-text margin-l-l amc-flex-1 amc-ellipsis"}],"css":"amc-cell-m-box amc-input-box-height"}],"css":"detail-cell"},{"tag":"div","css":"amc-1px-line"},{},{"tag":"div","css":"amc-abs-space-v-l"}],"css":"amc-v-box amc-hidden"},{},{"id":"cvv2ValidateSpace","tag":"div","children":[{"tag":"div","css":"amc-1px-line"},{"id":"cvv2Area","tag":"div","children":[{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{cvv_text}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1 l-label-ellipsis"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"cvv2","maxlength":"4","placeholder":"{{card_three_num}}","tag":"input","value":"","type":"number","css":"amc-input","oninput":"onInput('cvv2', 'cvvInfoLayout');"}],"css":"amc-cell-m-box amc-input-box-height"},{"id":"cvvInfoLayout","tag":"div","children":[{"id":"cvvInfoImg","alt":"{{info}}","tag":"img","onclick":"onClickInfo('cvv');","css":"amc-info-img"}],"css":"amc-btn-img info-img"}],"css":"detail-cell"}],"css":"amc-bg-white amc-v-box amc-hidden"},{},{"id":"validateArea","tag":"div","children":[{"tag":"div","css":"amc-margin-l amc-1px-line"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{validity_text}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1 l-label-ellipsis"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"validate","placeholder":"{{month_year}}","tag":"input","value":"","type":"month","css":"amc-input","oninput":"onInput('validate', 'validateInfoLayout');"}],"css":"amc-cell-m-box amc-input-box-height"},{"id":"validateInfoLayout","tag":"div","children":[{"id":"validateInfo","alt":"{{info}}","tag":"img","onclick":"onClickInfo('validate');","css":"amc-info-img"}],"css":"amc-btn-img info-img"}],"css":"detail-cell"}],"css":"amc-v-box amc-bg-white amc-hidden"},{"tag":"div","css":"amc-1px-line"},{"tag":"div","css":"amc-abs-space-v-l"}],"css":"amc-v-box"},{},{"id":"nameCertSpace","tag":"div","children":[{"tag":"div","css":"amc-1px-line"},{},{"id":"userNameArea","tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{name}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1 l-label-ellipsis"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"userName","placeholder":"{{input_name}}","tag":"input","value":"","css":"amc-input","oninput":"updateSubmitState()"}],"css":"amc-cell-m-box amc-input-box-height"}],"css":"detail-cell amc-bg-white amc-hidden"},{},{"id":"certTypeArea","tag":"div","children":[{"tag":"div","css":"amc-1px-line amc-margin-l"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{papers_type}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1 l-label-ellipsis"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"certType","tag":"label","children":[{"text":"{{papers_type}}","tag":"text"}],"css":"amc-font-m amc-theme-color amc-flex-1 amc-ellipsis"},{"id":"arrowRight","tag":"img"}],"onclick":"onClickCertType();","css":"amc-cell-m-box amc-input-box-height amc-flex-1"}],"css":"detail-cell "}],"css":"amc-v-box amc-bg-white amc-hidden"},{},{"id":"certNoArea","tag":"div","children":[{"tag":"div","css":"amc-1px-line amc-margin-l"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{id_no}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1 l-label-ellipsis"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"certNo","placeholder":"","tag":"input","value":"","css":"amc-input","oninput":"onInput('certNo');"}],"css":"amc-cell-m-box amc-input-box-height"}],"css":"detail-cell"}],"css":"amc-v-box amc-bg-white amc-hidden"},{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"id":"idCardOnly","tag":"label","children":[{"text":"{{id_card_only}}","tag":"text"}],"css":"amc-cell-footer-text amc-flex-1 amc-font-xs amc-hidden"}],"css":"amc-pd-lr footer-container amc-align-center"}],"css":"amc-v-box"},{},{"id":"bankMobileArea","tag":"div","children":[{"tag":"div","css":"amc-1px-line"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{phone_no}}","tag":"text"}],"css":"amc-cell-l-text amc-flex-1 l-label-ellipsis"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"bankMobile","placeholder":"{{input_bank_phone}}","tag":"input","value":"","css":"amc-input","oninput":"onInput('bankMobile', 'phoneInfoLayout');"}],"css":"amc-cell-m-box amc-input-box-height"},{"id":"phoneInfoLayout","tag":"div","children":[{"id":"phoneInfo","alt":"{{info}}","tag":"img","onclick":"onClickInfo('phone');"}],"css":"amc-btn-img info-img"}],"css":"detail-cell"},{"tag":"div","css":"amc-1px-line"}],"css":"amc-v-box amc-bg-white amc-hidden amc-margin-b-ss"},{},{"id":"protocolsArea","tag":"div","children":[{"tag":"label","children":[{"text":"{{agree}}","tag":"text"}],"css":"amc-protocol-text amc-margin-r-xs amc-ellipsis protocol-agree"},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{serve_protocol_full}}","tag":"text"}],"onclick":"showProtocol()","css":"amc-font-m amc-theme-color amc-flex-1"}],"css":"amc-flex-1 amc-pd-r"}],"css":"amc-align-center amc-pd-l amc-margin-b amc-hidden align-start"},{},{"tag":"div","children":[{"id":"submit","tag":"div","children":[{"id":"loading","tag":"img","src":"indicatior","css":"amc-loading-img amc-hidden amc-text-white-clolor"},{"id":"btnText","tag":"label","children":[{"text":"{{next}}","tag":"text"}],"css":"amc-btn-disabled-color amc-font-super-l amc-ellipsis amc-flex-1 amc-text-center"}],"onclick":"onSubmit();","disabled":"true","css":"amc-btn-primary amc-justify-center amc-align-center"}],"css":"amc-pd-lr"}],"css":"amc-main amc-scroll-android"},{"id":"dlg","tag":"dialog","children":[{"tag":"div","children":[{"id":"dlgTitle","tag":"label","css":"amc-dlg-title amc-ellipsis-3-line amc-flex-1 amc-text-center"}],"css":"amc-self-stretch"},{"tag":"div","children":[{"id":"dlgImg","tag":"img"}],"css":"amc-justify-center"},{"tag":"div","children":[{"id":"dlgText","tag":"label","css":"amc-dlg-txt dlg-txt amc-flex-1 amc-text-center"}],"css":"amc-self-stretch"},{"tag":"div","css":"amc-adapt-line amc-dlg-width"},{"tag":"button","children":[{"text":"{{i_know_it}}","tag":"text"}],"onclick":"getTag('dlg').close();","css":"amc-theme-color amc-dlg-btn"}],"css":"amc-dlg-box amc-v-box"}],"onkeydown":"onKeyDown();","css":"amc-body"}]},"format":"JSON","tplVersion":"5.0.8"}